/*!
 * decj Framework---eases your daily web frontend dev with declarative prograrmming
 * https://code.google.com/p/decj
 *
 * Copyright(C) 2013 Viscent Huang (viscent.huang@gmail.com)
 *
 */
;
define("decj",(function(){var b=["jquery","cssloader"];if("function"==typeof window.decjApp){var a=decjApp.config=decjApp();
if(a.amd){require.config(a.amd)}}var c=window.JSON;if(!(c&&c.parse&&c.stringify)){b.push("JSON")
}return b})(),function(A,n){var K,w=false,f={},t=[],i=function(){};if(window.ActiveXObject){window.console={log:function(){}}
}function m(M,O){var N=new Error();N.name=M;N.message=O;throw N}function p(P,M,O,N){m(N,M+":\n"+O)
}function e(M){this.name=M}e.attach=function(M){if(!w){return}return new e(M)};function u(T,O){if(!w){return
}var S=O||new Date();var Q=S.getHours();Q=(Q>=10)?Q:"0"+Q;var M=S.getMinutes();M=(M>=10)?M:"0"+M;
var P=S.getSeconds();P=(P>=10)?P:"0"+P;var N=S.getMilliseconds();var R="["+Q+":"+M+":"+P+"."+N+"]:";
if(window.console){console.log(R,T)}}function F(N){var M;if(A.isArray(N)){M=N}else{M=[];
if(undefined!=N){M=M.concat(N)}}return M}function D(S,Q,U){if(S.length!=Q.length){return false
}var M={},T,R,O=S.length;for(var N=O-1;N>=0;N--){M[(T=S[N])]=1}for(var N=O-1;N>=0;
N--){R=Q[N];if(U&&T!=R){return false}delete M[R]}for(var P in M){if(M.hasOwnProperty(P)){O=-1;
break}}return(-1!=O)}function E(){return function(){var O=[],N=arguments.callee,Q=N.extraArg,R;
for(var M=arguments.length,P=0;P<M;P++){O.push(arguments[P])}if(undefined!==Q){O=O.concat(Q)
}R=N.delegate.apply(N.ctx,O);if(true!=N.resident){N.ctx=N.extraArg=N.delegate=null
}return R}}Function.prototype.transform=function(M,O){var N=E();N._track=e.attach("Anonymous.f");
N.ctx=O;N.extraArg=M;N.delegate=this;return N};A(document).ajaxComplete(function(N,O,M){delete M.success
});function G(O,M,P,N){return N.fn.apply(N.ctx,[O].concat(N.args))}function y(O,N,M){return G.transform({fn:O,ctx:M,args:N})
}function d(M){if("string"==typeof M){M=document.forms[M]}this._htmlForm=M}d.prototype={get:function(){return this._htmlForm
},getId:function(){return this._id},finalize:function(){var M=A(this._htmlForm);A(M.prop("elements")).unbind();
A(B).append(M.unbind().remove()[0]).html("");M=null;delete d._instances[this._id];
z(this)}};d._id=-1;d._instances={};d.of=function(N){if("string"==typeof N){N=document.forms[N]
}var O=A(N).prop("_id");if(isNaN(O)){O=++d._id}var M=d._instances[O];if(undefined==M){A(N).prop("_id",O);
d._instances[O]=M=new d(N);M._id=O}return M};var v={locale:"en_US",validationNotify:function(N,P){var R=N.name,M=A(N).parent(),O=("LABEL"==M.prop("tagName"))?M:N,Q=A("#__vn_"+R);
if(0==Q.length){A("<span class='validationTip' id='__vn_"+R+"'>"+P+"</span>").insertAfter(O)
}else{Q.html(P)}}};var J=/\{(\w+)\}/g,g=/[\{|\}]/g;var L={supportedLocales:["en_US","zh_CN"],isLocaleSupported:function(M){return(A.inArray(M,L.supportedLocales)>=0)
},getLocale:function(N){var M=N||v.locale;M=L.isLocaleSupported(M)?M:L.supportedLocales[0];
return M},_resources:{},resources:function(){var P=arguments.length,O,N,M;if(2==P){O=arguments[0];
N=L.getLocale(arguments[1]);this._resources[N]=O}else{if(1==P){O=arguments[0];if("string"==typeof O){N=L.getLocale(O);
M=this._resources[N];if(!M){M=this._resources[N]={}}return M}N=L.getLocale();this._resources[N]=O
}}N=N?N:L.getLocale();M=this._resources[N];if(!M){M=this._resources[N]={}}return M
},resolveMessage:function(P,O){var M=L._resources[L.getLocale()]||{},N=M[P];if(undefined==N){return P
}N=N.replace(J,function(Q){Q=Q.replace(g,"");return O[Q]});return N},_fillInElement:function(N,O){var M,P;
M=A(O).attr("title");if(undefined!=M){P=L.resolveMessage(M);if(M!=P){A(O).prop("title",L.resolveMessage(M))
}}M=A(O).html();if(undefined!=M){P=L.resolveMessage(M);if(M!=P){if(A(O).hasClass("res-replace")){A(O).parent().attr("_msg",M);
O=A(O).replaceWith(P);A(B).append(O[0]).html("")}else{A(O).html(P)}return}}M=A(O).val();
if(undefined!=M&&O.type!="text"&&O.type!="checkbox"){P=L.resolveMessage(M);if(M!=P){A(O).val(P);
return}}},populateMsg:function(){A("[class*='res'],[class*='res-replace'],select,:input,form").each(L._fillInElement)
},cssURLFilter:function(O,N){var M=L.getLocale();if(0==O.indexOf("!")){O=O.substring(1)
}else{O=O.replace(".css","-"+M+".css");O=(v.cssBaseURL||"")+O}if(false===N){var P=new URL(O);
P.params.push("_="+new Date().getTime());O=P.toString()}return O}};String.prototype.val=function(){var Q=this.toString();
if(0==Q.indexOf("res ")){return L.resolveMessage(A.trim(Q.substring(4)),arguments[0]||{})
}if(0==Q.indexOf("event ")){Q=A.trim(Q.substring(6));var O,M,R;M=Q.split("@");O=M[1];
R=M[0];return decj.bindEvent(O,R,arguments[0])}if(0==Q.indexOf("module ")){var P=A.trim(Q.substring(7)),N=arguments[0];
return c(P,N)}};function j(M){this._cfg=M}j.prototype={attr:function(P,M){var O=this._cfg[P];
if(undefined==M){return O}if(undefined==O){m("FieldMetaData.attr","No such field "+P+"!")
}var N=O[M];switch(M){case"stereoType":N=N||"String";break;case"typeParam":N=N||{};
break;case"alias":N=N||P;break}return N},fieldNames:function(){var O=this._cfg;var N=[];
for(var M in O){if(O.hasOwnProperty(M)){N.push(M)}}return N}};var r={Size:{validate:function(P,Q){if(!Q.min&&!Q.max){return{valid:true}
}var O=Q.min||0,N=Q.max,M={};P=A.trim(P);if(P.length>=O&&P.length<=N){M.valid=true
}else{M.valid=false;M.message=((O==N)?"res Size.Exact":"res Size").val(Q)}return M
},validatorBound:function(M,N){A(M).attr("maxlength",N.max)}},DecimalMax:function(N,P){var O=P.value;
var M={};if(parseFloat(N)<=O){M.valid=true}else{M.valid=false;M.message="res DecimalMax".val(P)
}return M},DecimalMin:function(O,P){var N=P.value;var M={};if(parseFloat(O)>=N){M.valid=true
}else{M.valid=false;M.message="res DecimalMin".val(P)}return M},NotNull:function(O,P){var M={};
if(null==O){M.valid=false;M.message="res NotNull".val(P)}var N=A.trim(O);if(N.length>0){M.valid=true
}else{M.valid=false;M.message="res NotNull".val(P)}return M},Max:function(O,Q){var P=Q.value||Q.max;
var M={};var N;N=Number(O).valueOf();if(isNaN(N)){M.valid=false;M.message="res Digits".val();
return M}if(N<=P){M.valid=true}else{M.valid=false;M.message="res DecimalMax".val({value:P})
}return M},Min:function(P,Q){var O=Q.value||Q.min;var M={};var N;N=Number(P).valueOf();
if(isNaN(N)){M.valid=false;M.message="res Digits".val();return M}if(N>=O){M.valid=true
}else{M.valid=false;M.message="res DecimalMin".val({value:O})}return M}};var b={"ae,au,ca,cn,eg,gb,hk,il,in,jp,sk,th,tw,us":{decimalSep:".",thousandSep:","},"at,br,de,dk,es,gr,it,nl,pt,tr,vn":{decimalSep:",",thousandSep:"."},"cz,fi,fr,ru,se,pl":{decimalSep:",",thousandSep:" "},ch:{decimalSep:".",thousandSep:"'"},getCfg:function(M){var P,O=M.substring(M.indexOf("_")+1).toLowerCase();
for(var N in b){if(b.hasOwnProperty(N)&&(P=b[N])&&"function"!==typeof P){if(N.indexOf(O)>=0){return P
}}}}};function s(M){this._typeName=M}s.types={String:{impliedValidation:["Size"],parent:null},Number:{defaultTypeParam:{integer:9,fraction:7,rounding:true},formatter:function(Y,P){var U=A.extend(this.getDefaultTypeParam(),(P||{}));
var Z=U.locale||L.getLocale();var Q=b.getCfg(Z).decimalSep;var X=b.getCfg(Z).thousandSep;
var N=U.fraction||0;var O=U.rounding;var S=String(Y);var W=S.split(".");var V=W[0];
var ad=W[1]||"";if(O){S=Number(V+"."+ad);S=S.toFixed(N);W=S.split(".");V=W[0];ad=W[1]
}else{var ac=[];for(var ab=0;ab<N;ab++){ac.push(ad.charAt(ab)||"0")}ad=ac.join("")
}var M=[];var T;var aa=0;for(var ab=V.length-1;ab>=0;ab--){T=V.charAt(ab);M.push(T);
aa++;if(aa>0&&(0==aa%3)&&ab>0){M.push(X)}}var R=[];for(var ab=M.length-1;ab>=0;ab--){R.push(M[ab])
}if(undefined!=ad&&ad.length>0){R.push(Q);R.push(ad)}S=R.join("");return S},parser:function(T,N){var M=A.extend(this.getDefaultTypeParam(),(N||{})),S=M.locale||L.getLocale(),W=b.getCfg(S).decimalSep,U=b.getCfg(S).thousandSep,X=M.rounding,V=T,R,P=[];
for(var Q=V.length,O=0;O<Q;O++){R=V.charAt(O);if(R==U){continue}else{if(R==W){R="."
}}P.push(R)}V=P.join("");if(isNaN(Number(V))){m("ParseErr",V+" is not a valid number!")
}return V},isValid:function(X,Q){var aa=true;var N=A.extend(this.getDefaultTypeParam(),(Q||{}));
var V=N.locale||L.getLocale();var Z=b.getCfg(V).decimalSep;var Y=b.getCfg(V).thousandSep;
X=X||"";X=X.replace(new RegExp("\\"+Y,"g"),"");var S=X.split(Z);var O=S.length;if(O>=3){aa=false
}else{var M=N.integer;var U=N.fraction;var T=S[0];var R=S[1]||"0";S=String(parseFloat("0."+R)).split(".");
var W;W=(2==S.length)?S[1].length:0;var P=T.length;aa=(P<=M&&W<=U)}return aa}},Int:{parent:"Number",defaultTypeParam:{fraction:0,rounding:false},impliedValidation:["Max","Min"]},Decimal:{parent:"Number"},Boolean:{},Array:{parent:null},Date:{parser:function(Y,Q){Y=String(Y);
Y=A.trim(Y);if(Y.length==0){return Y}var X=A.extend(this.getDefaultTypeParam(),(Q||{})),N=X.format,ae=N.replace(/[yMd]/g,"").charAt(0),M=N.split(ae),af={};
for(var aa=0;aa<3;aa++){if(M[aa].indexOf("y")>=0){af.y=[aa,M[aa].length]}else{if(M[aa].indexOf("M")>=0){af.m=[aa,M[aa].length]
}else{if(M[aa].indexOf("d")>=0){af.d=[aa,M[aa].length]}else{}}}}var V=Y.split(ae),T,ac,Z,O=af.y[0],U=af.m[0],R=af.d[0];
T=V[O];if(4==af.y[1]&&T&&T.length!=af.y[1]){m("ParseErr","Invalid date part:"+T+"!")
}ac=V[U];if(2==af.m[1]&&ac&&ac.length!=af.m[1]){m("ParseErr","Invalid date part:"+ac+"!")
}Z=V[R];if(2==af.d[1]&&Z&&Z.length!=af.d[1]){m("ParseErr","Invalid date part:"+Z+"!")
}var ad=new Date().getFullYear();var ab=new Date((2==af.y[1])?parseInt(ad-(ad%1000))+parseInt(T):T,ac-1,Z);
var P=(2==af.y[1])?ab.getFullYear()%1000:ab.getFullYear();var W=(T==P&&(ac==ab.getMonth()+1)&&Z==ab.getDate());
if(!W){m("ParseErr","Invalid date:"+Y+"!")}var S=N.replace(/[y]+/g,T);return ab},formatter:function(T,O){var M=A.extend(this.getDefaultTypeParam(),(O||{}));
var N=M.format;var R,Q,S;var P=T;R=(-1!=N.indexOf("yyyy"))?P.getFullYear():(P.getFullYear()%1000);
Q=P.getMonth()+1;if(-1!=N.indexOf("MM")){if(Q<10){Q="0"+Q}}S=P.getDate();if(-1!=N.indexOf("dd")){if(S<10){S="0"+S
}}var U=N.replace(/y+/g,R);U=U.replace(/M+/g,Q);U=U.replace(/d+/g,S);return U}}};
s.prototype={getImpliedValidation:function(){var P=s.types,M=this._typeName,O=P[M],Q=[],N;
while(A.isPlainObject(O)){N=O.impliedValidation;if(A.isArray(N)&&N.length>0){Q=Q.concat(N)
}O=(O.parent)?P[O.parent]:null}return Q},getRootType:function(){var N=this._typeName,P=s.types,O=P[N],M=O.parent,Q=null;
while(M){Q=M;M=P[M].parent}return(null==Q)?N:Q},getConverter:function(){var O=this._typeName,Q=s.types,P=Q[O],M=[],N;
while(A.isPlainObject(P)){N=P.formatter;if(N){M[0]=N;break}P=(P.parent)?Q[P.parent]:null
}P=Q[O];var R;while(A.isPlainObject(P)){R=P.parser;if(R){M[1]=R;break}P=(P.parent)?Q[P.parent]:null
}return M},isValid:function(Q,R){var O=this._typeName,P=s.types,N=s.of(O).getRootType(),S=P[N].isValid,M=true;
if(S){M=S.apply(this,arguments)}return M},getDefaultTypeParam:function(){var P=this._typeName,R=s.types,Q=R[P],O=Q.parent,S=Q.defaultTypeParam||{},N=[];
N.push(S);while(O){Q=R[O];S=Q.defaultTypeParam||{};N.push(S);O=Q.parent}var M={};
while(N.length>0){A.extend(M,N.pop())}return M},parse:function(O,P){var N=this.getConverter(),Q=N[1],M=O;
if(Q){M=Q.apply(this,arguments)}return M},format:function(P,Q){var O=this.getConverter(),N=O[0],M=P;
if("string"==typeof M){M=A.trim(M);if(M.length==0){return M}}if(N){M=N.apply(this,arguments)
}return M}};s._cache={};s.of=function(O){var P=null;if(!O){O="String"}var Q=O.indexOf("[]");
if(Q>1){P=O.substring(0,Q);O="Array"}var N=s._cache;var M=N[O]||(N[O]=new s(O));M.cpntTypeName=P;
return M};s.register=function(M){A.extend(s.types,M)};function o(M){for(var N in M){r[N]=M[N]
}}function h(Q,M){M=M||Q;var T=M.events||{},N,R,P,O,U;for(var S in T){R=S.indexOf("@");
if(-1==R){continue}P=S.substr(0,R);O=S.substr(R+1);U=T[S];if(A.isPlainObject(U)){U=U.h.transform(U.extra,U.ctx||null)
}K.bindEvent(O,P,U)}}var l={};function x(M){this._htmlFormRef=M}x._id=-1;x._instances={};
x.of=function(O){var N=d.of(O);var P=N.getId();var M=x._instances[P];if(undefined==M){x._instances[P]=M=new x(N);
M._id=P}return M};x.validateField=function(U,Y,N,W){u("Form.validateField");var T,M,aa,P,R,X=U.name,Q=A(U).val(),S=A(U).attr("_stereoType"),Z=s.of(S).isValid(Q,N);
if(Z){try{Q=s.of(S).parse(Q,N)}catch(O){if("ParseErr"==O.name){Z=false}}}if(!Z){aa={valid:false,message:"res NotValidType".val({typeName:S}),value:Q};
return aa}if(A.isEmptyObject(Y)){return{valid:true,value:Q}}var R;for(var V in Y){if(!Y.hasOwnProperty(V)){continue
}R=Y[V];if(A.isFunction(R)){P={fieldName:X,field:U};M={validate:R}}else{P=R||{};M=r[V]||W[V];
if(A.isFunction(M)){M={validate:M}}P.fieldName=X}if(undefined==M){m("Form.validateField","Cannot find a validator for rule "+rulename)
}aa=M.validate.apply(M.ctx||null,[Q,P]);aa.value=Q;if(!aa.valid){if(w){u("Validation rule "+V+" NOT passed for field "+U.name)
}break}}return aa};x.prototype={_validateAndFormatField:function(U){var P=this._metaData.validation,S=A(U).attr("_alias")||U.name,M=P[S],V=P[S].validation,R=this._metaData.validators,T=M.stereoType,O=M.typeParam,W=x.validateField(U,V,O,R);
if(W.valid){var Q=A(U).val(),N=W.value;if("Date"==s.of(T).getRootType()){A(U).attr("_value",N.getTime())
}else{A(U).attr("_value",N)}Q=s.of(T).format(N,O);if(!A.isArray(Q)){U.value=Q}v.validationNotify(U,"")
}else{v.validationNotify(U,W.message);A(this).removeAttr("_value")}return this},_blurEvtHandler:function(M){x.of(this.form)._validateAndFormatField(this).trackChanges(M.target)
},_triggerValidatorBoundEvt:function(P){var R,N,O,Q,M=this._metaData,T=M.validators,U=M.validation[A(P).attr("_alias")||P.name].validation;
for(var S in U){Q=U[S];if(A.isPlainObject(Q)){O=r[S]||T[S];N=O.validatorBound;if(A.isFunction(N)){setTimeout(N.transform([P,Q]),50)
}}}},_bindBOValidatorAndFormatter:function(){var ab=this._metaData;ab.track=e.attach("Form._metaData");
var ah=ab.bo,Y=ah.name,V=ah.alias||Y,ae=ah.fieldsMetaData,R,P,S,T,af,ad,Q,aa={},O=[],ac;
ac=this._metaData.formDescriptor;A.each(ae,function(ak,ai){aa[ak]=ai;R=ai.validation||{};
ad=ai.alias||ak;P=ai.stereoType;S=s.of(P).getImpliedValidation();T={};af=ai.typeParam;
for(var aj=S.length-1;aj>=0;aj--){T[S[aj]]=af}A.extend(T,R);R=T;A.extend(R,(ac.validation||{})[ak]);
aa[ak].validation=R;Q=A("[name="+ad+"]","form[name="+V+"]");if(ak!=ad){Q.attr("_alias",ak)
}Q.attr("_stereoType",P);if(Q.length>=1){O.push(Q[0])}});var Z=ac.validation||{};
for(var ag in Z){var X=Z[ag];var W=X.stereoType||"String";var N=X.typeParam||{};delete X.stereoType;
delete X.typeParam;var M=A("[name="+ag+"]","form[name="+V+"]");if(aa[ag]){A.extend(aa[ag].validation,X);
delete aa[ag].validation.typeParam;if(undefined==aa[ag].typeParam){aa[ag].typeParam={}
}A.extend(aa[ag].typeParam,N)}else{aa[ag]={stereoType:W,typeParam:N,validation:X};
O.push(M[0])}M.attr("_stereoType",W)}var U=this;this._metaData.validation=aa;A(O).bind("blur",this._blurEvtHandler).each(function(ai,aj){U._triggerValidatorBoundEvt(aj)
});U=O=null},_interceptFormSubmit:function(N){var R=this,Q="form[name="+R.name+"]",P=A(Q+" :submit");
P.toggleClass("submitting").prop("disabled",true);var O=A(Q+" [type=image]");O.attr("_src",O.attr("src"));
O.attr("src",O.attr("_loading")).prop("disabled",true);var M;try{M=x.of(R).submit()
}catch(S){M=false;x.of(R)._enableSubmitBtn();if("validateForm"==S.name){u("Form data invalid!")
}else{N.preventDefault();throw S}}return M},_interceptFormReset:function(O){var N,M=("res "+(A(this).attr("_prompt")||"form.reset.prompt")).val(),Q=confirm(M);
if(!Q){O.preventDefault();return false}var P=x.of(this.form),R=P._metaData.backingData;
if(R){O.preventDefault();P.fillWithJSON(R,true);return false}return true},init:function(M){this._metaData=M;
this._bindBOValidatorAndFormatter();var P=this._htmlFormRef.get(),O="form[name="+P.name+"]";
if(1==A(O+" :submit").length){A(P).bind("submit",this,this._interceptFormSubmit)}A(O+" :reset").bind("click",this._interceptFormReset);
var N=new j(M.bo.fieldsMetaData);A.each(N.fieldNames(),function(S,T){var Q=N.attr(T,"alias"),R=N.attr(T,"stereoType");
A(P[Q]).attr("_alias",T).attr("_stereoType",R);if(R.indexOf("[]")>0){A(P[Q]).attr("_ordered",N.attr(T,"typeParam").ordered||"false")
}});P=null;return this},validate:function(){var N=this._metaData,S=N.validators,Q=this._htmlFormRef.get(),M=true,U,P,R,O,T;
if("String"==typeof Q){Q=document.forms[Q]}T=Q.name;O=N.validation;A.each(A(Q).prop("elements"),function(){if(!this.name){return
}R=A(this).attr("_alias")||this.name;U=O[R];if(!U){return}U=U.validation;P=O[R].typeParam||{};
if(A.isPlainObject(U)){M=M&&x.validateField(this,U,P,S).valid;A(this).blur();if(!M){return true
}}});Q=null;return M},_enableSubmitBtn:function(){var O=this._htmlFormRef.get(),N="form[name="+O.name+"]";
A(N+" :submit").toggleClass("submitting").prop("disabled",false);var M=A(N+" [type=image]");
M.attr("src",M.attr("_src")+"#"+new Date().getTime()).prop("disabled",false)},_formSubmitCallback:function(){var N=this._htmlFormRef.get();
var M=this._metaData.formDescriptor;if("success"!=arguments[1]&&!M.fail){alert("res form.sumbit-failed.prompt".val({formDesc:(N.title||N.name),error:arguments[2]}))
}this._enableSubmitBtn();(M.always||i).apply(null,arguments)},submit:function(){var O=this._htmlFormRef.get(),N=A(O).prop("_enctype")||A(O).prop("enctype");
if("multipart/form-data"==N){return true}var Q=x.of(O).validate();if(Q){var S=this._metaData.formDescriptor;
var P=S.filter;var M=A(O).prop("action");var R=x.of(O).collectData();if(null==R){m("decj.Form.submit","multipart/form-data not supported.")
}var T=R[0];var U=R[1];if(T instanceof Array){T=A.param(T)}else{T=JSON.stringify(T)
}c(S.processor,{resident:S.resident||true,httpRequest:{url:M,method:S.method||A(O).attr("method")||"POST",contentType:U,reqData:T,global:false,success:S.submitSuccess,error:S.fail,always:this._formSubmitCallback.transform(null,this),timeout:S.timeout,_track:e.attach("ajax")}})
}else{m("validateForm","Failed to pass validation,form:"+A(O).attr("name"))}return false
},_invokeDataFilter:function(O){var M=this._metaData,N=M.formDescriptor.filter;if(N){N(this._htmlFormRef.get(),O,M.backingData)
}},dataAsJSON:function(){var Y={},V,U,Q,T,N=this._metaData,W;W=new j(N.bo.fieldsMetaData);
for(var O=this._htmlFormRef.get(),M=O.elements,R=M.length-1;R>=0;R--){V=M[R];if(!V.name||V.disabled){continue
}U=A(V).attr("_alias")||V.name;if(undefined==W.attr(U)){continue}T=W.attr(U,"stereoType");
T=s.of(T).getRootType();Q=A(V).attr("_value")||V.value;if("Array"==T){T=s.of(W.attr(U,"stereoType")).cpntTypeName;
if(!A.isArray(Y[U])){Y[U]=[]}if(V.checked){Q=window[T](Q).valueOf();Y[U].push(Q)}for(var S,X=(V.options||[]),P=X.length-1;
P>=0;P--){S=X[P];if(S.selected){Q=window[T](S.value).valueOf();Y[U].push(Q)}}}else{if("Date"==T){Q=Number(Q).valueOf()
}else{Q=window[T](Q).valueOf()}if("radio"==V.type){if(V.checked){Y[U]=Q}}else{Y[U]=Q
}}}this._invokeDataFilter(Y);return Y},dataAsNVPair:function(){var M=[],O,N=this._metaData;
O=new j(N.bo.fieldsMetaData),form=this._htmlFormRef.get();A.each(A(form).serializeArray(),function(P,R){var Q=A(form[R.name]).attr("_alias")||R.name;
if(undefined==O.attr(Q)){return}R.value=s.of(O.attr(Q,"stereoType")).parse(R.value,O.attr(Q,"typeParam"));
if(R.value instanceof Date){R.value=R.value.getTime()}R.name=Q;M.push(R)});this._invokeDataFilter(M);
form=null;return M},collectData:function(){var M=this._htmlFormRef.get(),O=A(M).attr("_enctype")||A(M).attr("enctype"),P,Q,N=this._metaData.formDescriptor;
if(undefined==O){O=N.encodingType||"application/json"}if(-1!=O.indexOf("multi-part")){return null
}if(O.toLowerCase().indexOf("json")>=0){P=x.of(M).dataAsJSON();Q="application/json; charset=UTF-8"
}else{P=x.of(M).dataAsNVPair();Q="application/x-www-form-urlencoded; charset=UTF-8"
}return[P,Q]},fillWithJSON:function(X,ab){var Z,Y,R,V,O,N,P,U,M=this._htmlFormRef.get(),aa=new j(this._metaData.bo.fieldsMetaData),ac=aa.fieldNames();
for(var S=ac.length-1;S>=0;S--){Y=ac[S];U=aa.attr(Y,"alias")||Y;V=aa.attr(Y,"stereoType");
P=aa.attr(Y,"typeParam");var W=s.of(V);R=X[Y];Z=A(M[U]);if(0==Z.length){continue}Z=Z[0];
O=Z.tagName.toUpperCase();if(A.isArray(R)){if(O=="SELECT"){for(var T,Q=Z.options.length-1;
Q>=0;Q--){T=Z.options[Q];if(A.inArray(T.value,R)>=0){A(T).prop("selected",true)}}}else{A(M[U]).each(function(ad,ae){if(A.inArray(ae.value,R)>=0){A(ae).prop("checked",true)
}})}}else{if(Z.type=="radio"){A(M[U]).each(function(ad,ae){if(ae.value==R){A(ae).prop("checked",true)
}})}else{N=R;if(s.of(V).getRootType()=="Date"){if(R&&(R=A.trim(R)).length>0){R=new Date(Number(R))
}}if(undefined!=R){A(Z).attr("_value",N);R=W.format(R,P);A(Z).val(R);A(Z).attr("value",R)
}}}if(ab){A(Z).blur()}}M=null;this._metaData.backingData=X;return this},trackChanges:function(P){var N=this._htmlFormRef.get(),O=this._metaData.backingData||{},R=A(P).attr("_alias")||P.name;
if(!A.isEmptyObject(O)){var M=O[R],Q;if(A.isArray(M)){Q=D(A(P).val(),M,("true"==A(P).attr("_ordered")))
}else{Q=(M==A(P).attr("_value"))}if(Q){A(P).removeClass("valueChanged")}else{A(P).addClass("valueChanged")
}}},finalize:function(){delete x._instances[this._id];z(this,true)}};function a(M){try{(M.init||i).apply(M)
}catch(N){N.message="Error raised by init of module ["+M.id+"]:\n\r"+N.message;throw N
}}function c(Q,P){var R=arguments.length;if(0==R){return}if("string"==typeof Q){P=P||{}
}else{if(A.isPlainObject(Q)){P=Q;Q=undefined}}var O=P.resident||false;if(!O){var N=P.viewTarget||"wkspc";
P.viewTarget=N;var M=l[N];if(M&&!P.viewRender){decj.unloadModule(N)}}if(Q){P.moduleId=Q;
require([Q],k.transform(P))}else{if(A.isPlainObject(P)){k(P)}}}function q(O,M,P,N){A.Deferred(function(S){var Q={};
Q.data=O;var W=P.getResponseHeader("X-JS");if(W){Q.js=W;Q.id=W}var R=P.getResponseHeader("X-Screen");
if(R){Q.screen=R}var T=P.getResponseHeader("X-CSS");if(T){Q.css=T.split(";")}var V=P.getResponseHeader("X-Resources");
if(V){Q.resources=V.split(";")}var U=P.getResponseHeader("X-MetaData-URL");if(U){Q.metaDataURL=U
}require([W],S.resolve.transform(Q,S))}).done(function(Q){var R={};A.extend(R,Q);
var S={};A.extend(S,N);delete S.httpRequest;S.data=O;k(R,S);O=M=P=N=null})}function C(M){this.track=e.attach("PageStuffLoader");
this._options=M}C.prototype={defaultViewRender:function(M,O){var P=A("#"+O),N=P.parent();
P.detach();P.html(M);N.append(P)},loadScreen:function(N){u("Loading screen:"+N);var M=A.Deferred();
M.done(this.screenLoaded.transform(M,this));if(!N){M.resolve(null);return M}if(false==this._options.cache){var O=new URL(N);
O.params.push("_="+new Date().getTime());N=O.toString()}A.get(N,M.resolve.transform(undefined,M));
return M},screenLoaded:function(N){u("Screen loaded");if(null==N){return}var M=this._options;
viewTarget=M.viewTarget,viewRender=M.viewRender||this.defaultViewRender;if(viewRender!=this.defaultViewRender){A("#"+viewTarget).css("display","none")
}viewRender(N,viewTarget)},loadCSS:function(Q,R){u("Loading css:"+Q);var N=A.Deferred(),S=F(Q),M=this._options.cache;
N.done(this.cssLoaded.transform(undefined,this));for(var P=S.length-1;P>=0;P--){S[P]=L.cssURLFilter(S[P],M)
}var O=n({url:S,ownerModule:R,always:function(){N.resolve();if(O){O.finalize()}N=S=O=null
},crossDomainCSSLoadClue:function(T){var U=this.crossDomainCSSLoadClue(T);U=U.replace("-"+L.getLocale(),"");
return U}}).load();return N},cssLoaded:function(N,M){u("CSS loaded:")},loadRes:function(N){u("Loading resources");
var O=A.Deferred(),Q=[],M=L.getLocale(),R=F(N.resources);O.done(this.resourcesLoaded.transform(undefined,this));
for(var P=R.length-1;P>=0;P--){Q.push(R[P]+"-"+M)}require(Q,O.resolve.transform(N,O));
return O},resourcesLoaded:function(){u("Resources loaded");var O=L.resources(),M=arguments[arguments.length-1];
M.loadedResources=[];for(var N=arguments.length-2;N>=0;N--){M.loadedResources.push(arguments[N]);
A.extend(O,arguments[N])}},paintUI:function(M){u("Painting UI");var N=A.Deferred(),O=this.loadScreen(M.screen);
A.when(O,this.loadRes(M)).done(function(){u("UI painted");L.populateMsg();N.resolve();
M=N=null});return N},showUI:function(M,O){var P=A.Deferred(),N=this.paintUI(M);A.when(N,this.loadCSS(M.css,M.id)).done(function(){var Q=O.viewTarget;
A("#"+Q).css("display","block");P.resolve();M=P=null});return[P,N]},loadModuleData:function(M,Q){u("Loading module data");
var O=A.Deferred(),P=Q.httpRequest,N=this;O.done(this.moduleDataLoaded.transform(O,this));
if(P){A.ajax(P.url,{type:P.method,contentType:P.contentType,data:P.reqData,global:(i===P.cbFail),success:y(O.resolve,[M,Q],O),error:P.fail,timeout:P.timeout,_track:e.attach("ajax")})
}else{var R=M.data=Q.data||{};O.resolveWith(N,[R,M,Q])}return O},moduleDataLoaded:function(P,M,O){u("Module data loaded");
if(M){M.data=P}var N=O.httpRequest;if(N&&N.success){N.success(P,M,O)}},loadModuleMetaData:function(M){u("Loading module metadata");
var O=A.Deferred(),N=this;O.done(this.moduleMetaDataLoaded.transform(undefined,this));
if(M.metaDataURL){A.getJSON(M.metaDataURL,y(O.resolve,M,O)).fail(p.transform("ajax.getModuleMetaData"))
}else{O.resolveWith(N,[{},M])}return O},moduleMetaDataLoaded:function(N,M){u("Module metadata loaded");
if(M){M.metaData=N}},initModule:function(Q,O,M,R,X){u("init module");var P=R.id;l[X.viewTarget||P]=R;
var S=X.viewTarget||"wkspc";A("#"+S).css("display","block");(R.preInit||i).apply(R);
setTimeout(h.transform(R),0);R.metaData=R.metaData||{};var T=R.metaData.bo;var V;
for(var U in T){if(!T.hasOwnProperty(U)){continue}V=T[U];var W=V.alias||U,N={bo:{name:U,type:V.type,alias:W,fieldsMetaData:R.metaData.boMetaData[V.type]},validators:R.validators||{},formDescriptor:(R.forms||{})[W]||{}};
if(R.data){x.of(W).init(N).fillWithJSON(R.data[U]||{})}}a(R);if(X.httpRequest){(X.httpRequest.always||i)(R)
}R=null;this.finalize();u("module inited")},finalize:function(){z(this,true)}};function k(O,Q){var R=arguments.length;
if(2==R){var N=K.App.locale||Q.locale||(window.navigator.userLanguage||window.navigator.language);
K.setLocale(N);O.track=e.attach("objModule");O.resources=F(O.resources);O.resources.push("decjres");
var M=new C(Q);O.id=(O.id||Q.moduleId||O.js);var S=M.showUI(O,Q);A.when(S[1],M.loadModuleData(O,Q),M.loadModuleMetaData(O)).done(M.initModule.transform([O,Q],M))
}else{if(1==R){var Q=O;var P=Q.httpRequest;if(P){A.ajax(P.url,{type:P.method,contentType:P.contentType,data:P.reqData,global:(i===P.fail),success:P.success||q.transform(Q),error:P.fail,timeout:P.timeout,_track:e.attach("ajax")}).always(P.always||i)
}}}}function I(Q,O,P,N){if(N){if(P&&"function"==typeof P.finalize){P.finalize()}else{if(A.isArray(P)){for(var M=P.length-1;
M>-0;M--){if("function"==typeof P[M].finalize){P[M].finalize()}}}}}delete Q[O]}function z(N,M){if(N==window){return
}A.each(N,function(O,P){I(N,O,P,M)});N=null}var B=null;var H=/[^a-z]/i;K={version:"0.1.0",App:v,setLocale:function(N){var M=N.split(H);
M[0]=M[0].toLowerCase();if(M.length==2){M[1]=M[1].toUpperCase()}N=M.join("_");N=L.getLocale(N);
v.locale=N;return N},startup:function(M){A.Deferred(function(N){M=M||f;A.extend(v,M);
o(M.validators||{});s.register(M.types||{});var O=v;(O.preInit||i).apply(O,[A,K]);
require(O.requires||["jquery","decj"],N.resolve.transform(O,N))}).done(function(){var N=arguments;
A(function(){B=document.createElement("DIV");B.style.display="none";A(document.body).append(B);
var P=N[N.length-1];var O=F(P.initialModule);if(O){K.loadModule.apply(K,O)}(P.init||i).apply(null,N);
M=null})})},loadModule:c,unloadModule:function(Q){u("Unload module:"+Q);var P=l[Q];
if(!P){u("Cannot find module:"+Q);return}var N=P.id;var V;for(var Z in P.events){if(-1==(V=Z.indexOf("@"))){continue
}A(Z.substr(V+1)).unbind()}var R=P.metaData.bo;var O;for(var aa in R){if(!R.hasOwnProperty(aa)){continue
}O=document.forms[R[aa].alias||aa];x.of(O).finalize();O=null}var M=P.loadedResources||[];
var ab=L.resources();for(var X,S=M.length-1;S>=0;S--){X=M[S];for(var T in X){if(ab.hasOwnProperty(T)){delete ab[T]
}}}M=null;delete l[Q];A("link[_ownerModule='"+N+"']").remove();A("style[_ownerModule='"+N+"']").remove();
var Y=L.getLocale();var U=(P.requiredJS||[]).concat((P.resources||[]));if(P.id){U.push(P.id)
}var W;for(var S=U.length-1;S>=0;S--){W=U[S];if(W=="decj"||W=="cssloader"){continue
}if(0==W.indexOf("res/")){W+="-"+Y}requirejs.undef(W);A("script[data-requiremodule='"+W+"']").remove()
}if(P.finalize){try{P.finalize()}catch(W){m("finalize module:"+N,W.message)}finally{z(P);
P=null;if("function"==typeof CollectGarbage){setTimeout(CollectGarbage,500)}}}A("#"+Q).html("")
},bindEvent:function(M,O,N){A(M).bind(O,N)},registerCommonValidators:o,validateForm:function(M){return x.of(M).validate()
},formDataAsJson:function(M){return x.of(M).dataAsJSON()},regType:s.register,submitForm:function(M){return x.of(M).submit()
},StereoType:s};window.decj=K;K.startup(decjApp.config);return K});